# 领域事件 Domain Events

领域专家所关心的已经发生的事情。  

实体负责跟踪自身的状态，并具有管理自身生命周期的规则。但是，通过实体通常无法明确地知道状态变化背后的原因，也很难解释系统是如何变成现在的样子的。审计追踪功能可以用于跟踪系统的操作轨迹，但通常不适于跟踪程序本身的逻辑。通过变更历史可以访问实体以前的状态，但无法了解这些变化的意义。因此，对信息的操作都只存在于程序运行的过程中，而在领域层中则没有体现。  

分布式系统中有一些不同但相关的问题。在分布式系统中，无法在任何时候都保持状态的完全一致。聚合能够始终保持内部的一致性，而其他更改则是异步的。由于变更会在网络的各节点间传播，因此很难解决多个打乱顺序的或发起自不同来源的更新。  

因此:  

**将领域中有关活动的信息建模为一系列离散的事件。将每个事件表示为一个领域对象。领域事件与系统事件是不同的，系统事件反映软件自身的内部活动，尽管系统事件常常与领域事件相关联。系统事件可以作为领域事件响应的一部分，或者作为将领域事件的信息传递给系统的一种方式。**  

**领域事件在领域模型中是一个完整的组成部分，代表了领域中已经发生的事情。应该忽略掉那些不相干的领域活动，而对于领域专家想要跟踪或被通知的事件，或其他模型对象的状态变化所引发的事件，则应显式地表达出来。**  

在分布式系统中，对于一个特定的节点，可以从当前已知的领域事件中推断出实体的状态，从而在缺乏系统整体信息的情况下建立一致的模型。  

领域事件通常是不可变的，因为它们是过去所发生事情的记录。除了对事件的描述以外，领域事件通常还包含表示事件何时发生的时间戳，以及事件所涉及到的那些实体的标识。此外，领域事件通常还有表示事件何时输入系统的时间戳，以及将事件输入系统的人员的标识。在恰当的情况下，领域事件的标识可以基于上述属性的某种集合。这样，比如说，如果同一事件的两个实例到达了同一节点，系统就可以识别出它们是相同的。  
你你你ni你舍设